<!DOCTYPE html>
<!-- Cache-Buster: 1763994674 -->

<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panneau d'Administration - VPS DevOps Agent</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .stat-card {
            transition: transform 0.2s;
        }
        .stat-card:hover {
            transform: translateY(-5px);
        }
        .table-hover tbody tr:hover {
            background-color: #f3f4f6;
        }
        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .badge-success { background-color: #10b981; color: white; }
        .badge-warning { background-color: #f59e0b; color: white; }
        .badge-danger { background-color: #ef4444; color: white; }
        .badge-info { background-color: #3b82f6; color: white; }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.5rem;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
    </style>
    <link rel="stylesheet" href="/iframe-styles.css">
</head>
<body class="bg-gray-100">
    <script src="/iframe-detector.js"></script>
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-gray-800">
                        <i class="fas fa-shield-alt text-purple-600 mr-2"></i>
                        Panneau d'Administration
                    </h1>
                    <p class="text-gray-600 mt-1">Gestion compl√®te de la plateforme VPS DevOps Agent</p>
                </div>
                <button onclick="handleRefresh()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg">
                    <i class="fas fa-sync-alt mr-2"></i>Actualiser
                </button>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="bg-white rounded-lg shadow-lg mb-6">
            <div class="flex overflow-x-auto border-b">
                <button onclick="switchTab('dashboard')" class="tab-button active px-6 py-4 font-semibold" data-tab="dashboard">
                    <i class="fas fa-chart-line mr-2"></i>Tableau de Bord
                </button>
                <button onclick="switchTab('users')" class="tab-button px-6 py-4 font-semibold" data-tab="users">
                    <i class="fas fa-users mr-2"></i>Utilisateurs
                </button>
                <button onclick="switchTab('payments')" class="tab-button px-6 py-4 font-semibold" data-tab="payments">
                    <i class="fas fa-credit-card mr-2"></i>Paiements
                </button>
                <button onclick="switchTab('plans')" class="tab-button px-6 py-4 font-semibold" data-tab="plans">
                    <i class="fas fa-box mr-2"></i>Plans
                </button>
                <button onclick="switchTab('settings')" class="tab-button px-6 py-4 font-semibold" data-tab="settings">
                    <i class="fas fa-cog mr-2"></i>Param√®tres
                </button>
                <button onclick="switchTab('ai-keys')" class="tab-button px-6 py-4 font-semibold" data-tab="ai-keys">
                    <i class="fas fa-key mr-2"></i>Cl√©s API IA
                </button>
            </div>
        </div>

        <!-- Tab Contents -->
        
        <!-- Dashboard Tab -->
        <div id="tab-dashboard" class="tab-content">
            <!-- Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                <div class="stat-card bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-lg shadow-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-100 text-sm">Utilisateurs Totaux</p>
                            <h3 class="text-3xl font-bold mt-2" id="stat-total-users">-</h3>
                        </div>
                        <i class="fas fa-users text-5xl opacity-20"></i>
                    </div>
                </div>

                <div class="stat-card bg-gradient-to-br from-green-500 to-green-600 text-white rounded-lg shadow-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-100 text-sm">Abonnements Actifs</p>
                            <h3 class="text-3xl font-bold mt-2" id="stat-active-subs">-</h3>
                        </div>
                        <i class="fas fa-check-circle text-5xl opacity-20"></i>
                    </div>
                </div>

                <div class="stat-card bg-gradient-to-br from-yellow-500 to-yellow-600 text-white rounded-lg shadow-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-yellow-100 text-sm">Paiements en Attente</p>
                            <h3 class="text-3xl font-bold mt-2" id="stat-pending-payments">-</h3>
                        </div>
                        <i class="fas fa-clock text-5xl opacity-20"></i>
                    </div>
                </div>

                <div class="stat-card bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-lg shadow-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-purple-100 text-sm">Revenus du Mois</p>
                            <h3 class="text-3xl font-bold mt-2" id="stat-revenue">-</h3>
                        </div>
                        <i class="fas fa-dollar-sign text-5xl opacity-20"></i>
                    </div>
                </div>
            </div>

            <!-- Charts -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Utilisateurs par Plan</h3>
                    <canvas id="chart-users-by-plan"></canvas>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Revenus Mensuels</h3>
                    <canvas id="chart-revenue"></canvas>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">Activit√© R√©cente</h3>
                <div id="recent-activity" class="space-y-3">
                    <!-- Will be populated dynamically -->
                </div>
            </div>
        </div>

        <!-- Users Tab -->
        <div id="tab-users" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <!-- Search and Filters -->
                <div class="flex flex-wrap gap-4 mb-6">
                    <input type="text" id="user-search" placeholder="Rechercher par nom ou email..." 
                           class="flex-1 min-w-[200px] px-4 py-2 border rounded-lg">
                    <select id="user-role-filter" class="px-4 py-2 border rounded-lg">
                        <option value="">Tous les r√¥les</option>
                        <option value="admin">Admin</option>
                        <option value="user">Utilisateur</option>
                    </select>
                    <select id="user-status-filter" class="px-4 py-2 border rounded-lg">
                        <option value="">Tous les statuts</option>
                        <option value="active">Actif</option>
                        <option value="inactive">Inactif</option>
                    </select>
                    <button onclick="searchUsers()" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg">
                        <i class="fas fa-search mr-2"></i>Rechercher
                    </button>
                </div>

                <!-- Users Table -->
                <div class="overflow-x-auto">
                    <table class="table-hover min-w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Utilisateur</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Plan</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Statut</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Inscrit le</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="users-table-body" class="bg-white divide-y divide-gray-200">
                            <!-- Will be populated dynamically -->
                        </tbody>
                    </table>
                </div>

                <!-- Pagination -->
                <div id="users-pagination" class="mt-6 flex justify-between items-center">
                    <!-- Will be populated dynamically -->
                </div>
            </div>
        </div>

        <!-- Payments Tab -->
        <div id="tab-payments" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">Paiements en Attente de Validation</h3>
                <div id="pending-payments-list" class="space-y-4">
                    <!-- Will be populated dynamically -->
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-lg p-6 mt-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">Historique des Paiements</h3>
                <div class="overflow-x-auto">
                    <table class="table-hover min-w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID Transaction</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Utilisateur</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Montant</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">M√©thode</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Statut</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                            </tr>
                        </thead>
                        <tbody id="payments-table-body" class="bg-white divide-y divide-gray-200">
                            <!-- Will be populated dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Plans Tab -->
        <div id="tab-plans" class="tab-content hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="plans-grid">
                <!-- Will be populated dynamically -->
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="tab-settings" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-6">Param√®tres Syst√®me</h3>
                <div id="settings-list" class="space-y-4">
                    <!-- Will be populated dynamically -->
                </div>
            </div>
        </div>

        <!-- AI Keys Tab -->
        <div id="tab-ai-keys" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-gray-800">Cl√©s API Intelligence Artificielle</h3>
                    <button onclick="showAddAIKeyModal()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg">
                        <i class="fas fa-plus mr-2"></i>Ajouter une Cl√©
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="table-hover min-w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Provider</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nom</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cl√© API</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Utilisateur</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Limite Mensuelle</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Par D√©faut</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ai-keys-table-body" class="bg-white divide-y divide-gray-200">
                            <!-- Will be populated dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- User Detail Modal -->
    <div id="user-detail-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold">D√©tails Utilisateur</h2>
                <button onclick="closeModal('user-detail-modal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <div id="user-detail-content">
                <!-- Will be populated dynamically -->
            </div>
        </div>
    </div>

    <!-- Add AI Key Modal -->
    <div id="add-ai-key-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold">Ajouter une Cl√© API IA</h2>
                <button onclick="closeModal('add-ai-key-modal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <form id="add-ai-key-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Provider</label>
                    <select id="ai-key-provider" required class="w-full px-4 py-2 border rounded-lg">
                        <option value="openai">OpenAI</option>
                        <option value="anthropic">Anthropic</option>
                        <option value="google">Google AI</option>
                        <option value="mistral">Mistral AI</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nom (optionnel)</label>
                    <input type="text" id="ai-key-name" class="w-full px-4 py-2 border rounded-lg" placeholder="Ma cl√© de production">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Cl√© API</label>
                    <input type="text" id="ai-key-api-key" required class="w-full px-4 py-2 border rounded-lg" placeholder="sk-...">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Secret API (optionnel)</label>
                    <input type="text" id="ai-key-api-secret" class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Limite Mensuelle USD (optionnel)</label>
                    <input type="number" id="ai-key-monthly-limit" class="w-full px-4 py-2 border rounded-lg" placeholder="100">
                </div>
                <div class="flex items-center">
                    <input type="checkbox" id="ai-key-is-default" class="mr-2">
                    <label for="ai-key-is-default" class="text-sm font-medium text-gray-700">D√©finir comme cl√© par d√©faut</label>
                </div>
                <div class="flex gap-4">
                    <button type="submit" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg">
                        Ajouter
                    </button>
                    <button type="button" onclick="closeModal('add-ai-key-modal')" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg">
                        Annuler
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>

// ==========================================
// TOKEN MANAGEMENT FOR ADMIN PANEL
// ==========================================

let authToken = null;

// Listen for messages from parent dashboard
window.addEventListener('message', (event) => {
    if (event.origin !== window.location.origin) {
        console.warn('‚ö†Ô∏è Message from unauthorized origin:', event.origin);
        return;
    }
    
    console.log('üì© Message received from parent:', event.data);
    
    const { type, token } = event.data;
    
    switch (type) {
        case 'AUTH_TOKEN':
            handleAuthToken(token);
            break;
        default:
            console.log('üì© Message type:', type);
    }
});

function handleAuthToken(token) {
    if (!token) {
        console.error('‚ùå No token provided');
        return;
    }
    
    try {
        localStorage.setItem('authToken', token);
        authToken = token;
        console.log('‚úÖ Token received and saved from parent dashboard');
        
        // Initialize the admin panel with the token
        initializeAdminPanel();
        
    } catch (error) {
        console.error('‚ùå Error handling token:', error);
    }
}

function getAuthToken() {
    console.log("üîç [getAuthToken] Called");
    console.log("üîç [getAuthToken] Current authToken:", authToken ? "ALREADY SET" : "NULL");
    
    if (!authToken) {
        authToken = localStorage.getItem('authToken');
        console.log("üîç [getAuthToken] Retrieved from localStorage:", authToken ? "FOUND (length: " + authToken.length + ")" : "NOT FOUND");
    }
    
    console.log("üîç [getAuthToken] Returning:", authToken ? "TOKEN PRESENT" : "NULL");
    return authToken;
}

function initializeAdminPanel() {
    console.log('üöÄ Initializing admin panel...');
    authToken = getAuthToken();
    
    if (!authToken) {
        console.warn('‚ö†Ô∏è No token available yet, waiting for parent...');
        return;
    }
    
    console.log('‚úÖ Token available, loading admin data...');
    
    // Load all admin data
    console.log("üîç [init] Calling loadDashboard()...");
    loadDashboard();
    console.log("üîç [init] Calling loadUsers()...");
    loadUsers();
    console.log("üîç [init] Calling loadPendingPayments()...");
    loadPendingPayments();
    console.log("üîç [init] Calling loadPlans()...");
    loadPlans();
    console.log("üîç [init] Calling loadSettings()...");
    loadSettings();
    console.log("üîç [init] Calling loadAIKeys()...");
    loadAIKeys();
}

// Request token from parent on load
document.addEventListener('DOMContentLoaded', function() {
    console.log('üöÄ Admin panel page loading...');
    
    const existingToken = getAuthToken();
    
    if (existingToken) {
        console.log('‚úÖ Token found in localStorage');
        authToken = existingToken;
        initializeAdminPanel();
    } else {
        console.log('‚ö†Ô∏è No token found, waiting for parent...');
        
        // If in iframe, wait for token from parent
        if (window.parent && window.parent !== window) {
            setTimeout(() => {
                window.parent.postMessage({
                    type: 'REQUEST_TOKEN'
                }, window.location.origin);
            }, 500);
        }
    }
});


        let currentTab = 'dashboard';
        let currentPage = 1;

        // Initialize
        // NOTE: Initialization is now handled by the token handler above
        // which properly receives the token from the parent dashboard via postMessage

        // API Helper
        async function apiCall(endpoint, options = {}) {
            console.log("üîç [apiCall] Called with endpoint:", endpoint);
            console.log("üîç [apiCall] authToken value:", authToken ? "PRESENT" : "MISSING");
            
            if (!authToken) {
                console.error("‚ùå [apiCall] No authToken available!");
                throw new Error("No authentication token available");
            }
            console.log("üîç [apiCall] Making fetch request to:", `/api${endpoint}`);
            const response = await fetch(`/api${endpoint}`, {
                ...options,
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${authToken}`,
                    ...options.headers
                }
            });
            
            console.log("üîç [apiCall] Response status:", response.status);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const data = await response.json();
            console.log("‚úÖ [apiCall] Response data received:", data);
            return data;
        }

        // Tab Switching
        window.switchTab = function(tabName) {
            currentTab = tabName;
            
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Show selected tab
            document.getElementById(`tab-${tabName}`).classList.remove('hidden');
            
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        }

        // Load Dashboard
        window.loadDashboard = async function() {
            console.log("üîç [loadDashboard] Function called");
            try {
                console.log("üîç [loadDashboard] About to call API...");
                const data = await apiCall('/admin/dashboard');
                console.log("üîç [loadDashboard] API call completed");
                
                if (data.success && data.data) {
                    const stats = data.data;
                    document.getElementById('stat-total-users').textContent = stats.totalUsers || 0;
                    document.getElementById('stat-active-subs').textContent = stats.activeSubscriptions || 0;
                    document.getElementById('stat-pending-payments').textContent = stats.pendingPayments || 0;
                    document.getElementById('stat-revenue').textContent = `${stats.monthlyRevenue || 0}‚Ç¨`;
                    
                    // TODO: Initialize charts with stats data
                }
            } catch (error) {
                console.error('Failed to load dashboard:', error);
                showNotification('Erreur lors du chargement du tableau de bord', 'error');
            }
        }

        // Load Users
        window.loadUsers = async function(page = 1) {
            console.log("üîç [loadUsers] Function called, page:", page);
            try {
                console.log("üîç [loadUsers] Getting search filters...");
                const search = document.getElementById('user-search')?.value || '';
                const role = document.getElementById('user-role-filter')?.value || '';
                const status = document.getElementById('user-status-filter')?.value || '';
                
                const queryParams = new URLSearchParams({
                    page,
                    limit: 20,
                    ...(search && { search }),
                    ...(role && { role }),
                    ...(status && { status })
                });
                
                const data = await apiCall(`/admin/users?${queryParams}`);
                
                if (data.success && data.data) {
                    displayUsers(data.data.users);
                    displayPagination(data.data.pagination, 'users');
                }
            } catch (error) {
                console.error('Failed to load users:', error);
                showNotification('Erreur lors du chargement des utilisateurs', 'error');
            }
        }

        function displayUsers(users) {
            const tbody = document.getElementById('users-table-body');
            tbody.innerHTML = users.map(user => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10 bg-purple-600 rounded-full flex items-center justify-center text-white font-bold">
                                ${user.username.charAt(0).toUpperCase()}
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${user.username}</div>
                                <div class="text-sm text-gray-500">${user.role}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${user.email}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${user.currentPlan}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="badge ${user.isActive ? 'badge-success' : 'badge-danger'}">
                            ${user.isActive ? 'Actif' : 'Inactif'}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${new Date(user.createdAt).toLocaleDateString('fr-FR')}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="viewUserDetails('${user.id}')" class="text-purple-600 hover:text-purple-900 mr-3">
                            <i class="fas fa-eye"></i> Voir
                        </button>
                        <button onclick="editUser('${user.id}')" class="text-blue-600 hover:text-blue-900">
                            <i class="fas fa-edit"></i> Modifier
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // Load Pending Payments
        window.loadPendingPayments = async function() {
            try {
                const data = await apiCall('/admin/payments/pending');
                
                if (data.success && data.payments) {
                    displayPendingPayments(data.payments);
                }
            } catch (error) {
                console.error('Failed to load pending payments:', error);
            }
        }

        function displayPendingPayments(payments) {
            const container = document.getElementById('pending-payments-list');
            
            if (payments.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">Aucun paiement en attente</p>';
                return;
            }
            
            container.innerHTML = payments.map(payment => `
                <div class="border rounded-lg p-4 hover:shadow-md transition">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-semibold text-gray-800">${payment.username}</h4>
                            <p class="text-sm text-gray-600">${payment.planName} - ${payment.amount}‚Ç¨</p>
                            <p class="text-xs text-gray-500 mt-1">ID: ${payment.transactionId}</p>
                            <p class="text-xs text-gray-500">Date: ${new Date(payment.createdAt).toLocaleString('fr-FR')}</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="validatePayment('${payment.transactionId}')" 
                                    class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm">
                                <i class="fas fa-check mr-1"></i>Valider
                            </button>
                            <button onclick="rejectPayment('${payment.transactionId}')" 
                                    class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm">
                                <i class="fas fa-times mr-1"></i>Rejeter
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Validate Payment
        async function validatePayment(transactionId) {
            if (!confirm('√ätes-vous s√ªr de vouloir valider ce paiement ?')) return;
            
            try {
                const data = await apiCall(`/admin/payments/${transactionId}/validate`, {
                    method: 'POST'
                });
                
                if (data.success) {
                    showNotification('Paiement valid√© avec succ√®s', 'success');
                    loadPendingPayments();
                    loadDashboard();
                }
            } catch (error) {
                console.error('Failed to validate payment:', error);
                showNotification('Erreur lors de la validation du paiement', 'error');
            }
        }

        // Reject Payment
        async function rejectPayment(transactionId) {
            const reason = prompt('Raison du rejet:');
            if (!reason) return;
            
            try {
                const data = await apiCall(`/admin/payments/${transactionId}/reject`, {
                    method: 'POST',
                    body: JSON.stringify({ reason })
                });
                
                if (data.success) {
                    showNotification('Paiement rejet√©', 'success');
                    loadPendingPayments();
                }
            } catch (error) {
                console.error('Failed to reject payment:', error);
                showNotification('Erreur lors du rejet du paiement', 'error');
            }
        }

        // Load Plans
        window.loadPlans = async function() {
            try {
                const data = await apiCall('/admin/plans');
                
                if (data.success && data.plans) {
                    displayPlans(data.plans);
                }
            } catch (error) {
                console.error('Failed to load plans:', error);
            }
        }

        function displayPlans(plans) {
            const grid = document.getElementById('plans-grid');
            grid.innerHTML = plans.map(plan => `
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">${plan.display_name}</h3>
                    <div class="text-4xl font-bold text-purple-600 mb-4">${plan.price_usd}‚Ç¨<span class="text-lg text-gray-500">/mois</span></div>
                    <p class="text-gray-600 mb-4">${plan.description || 'Aucune description'}</p>
                    <div class="space-y-2 mb-4">
                        <div class="text-sm text-gray-700">
                            <i class="fas fa-server text-purple-600 mr-2"></i>Serveurs: ${plan.max_projects || 'Illimit√©'}
                        </div>
                        <div class="text-sm text-gray-700">
                            <i class="fas fa-terminal text-purple-600 mr-2"></i>Commandes: ${plan.max_ai_calls || 'Illimit√©'}/jour
                        </div>
                    </div>
                    <button onclick="editPlan('${plan.id}')" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg">
                        <i class="fas fa-edit mr-2"></i>Modifier
                    </button>
                </div>
            `).join('');
        }

        // Load Settings
        window.loadSettings = async function() {
            try {
                const data = await apiCall('/admin/settings');
                
                if (data.success && data.settings) {
                    displaySettings(data.settings);
                }
            } catch (error) {
                console.error('Failed to load settings:', error);
            }
        }

        function displaySettings(settings) {
            const container = document.getElementById('settings-list');
            
            // Handle if settings is an object grouped by category
            let settingsArray = [];
            if (Array.isArray(settings)) {
                settingsArray = settings;
            } else if (typeof settings === 'object') {
                // Flatten grouped settings object into array
                Object.values(settings).forEach(categorySettings => {
                    if (Array.isArray(categorySettings)) {
                        settingsArray = settingsArray.concat(categorySettings);
                    }
                });
            }
            
            if (settingsArray.length === 0) {
                container.innerHTML = '<div class="text-center py-8 text-gray-500">Aucun param√®tre configur√©</div>';
                return;
            }
            
            container.innerHTML = settingsArray.map(setting => `
                <div class="border rounded-lg p-4">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-semibold text-gray-800">${setting.key}</h4>
                            <p class="text-sm text-gray-600 mt-1">${setting.value}</p>
                            ${setting.description ? `<p class="text-xs text-gray-400 mt-1">${setting.description}</p>` : ''}
                        </div>
                        <button onclick="editSetting('${setting.key}')" class="text-purple-600 hover:text-purple-900">
                            <i class="fas fa-edit"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Load AI Keys
        window.loadAIKeys = async function() {
            try {
                const data = await apiCall('/admin/ai-keys');
                
                if (data.success && data.aiKeys) {
                    displayAIKeys(data.aiKeys);
                }
            } catch (error) {
                console.error('Failed to load AI keys:', error);
            }
        }

        function displayAIKeys(keys) {
            const tbody = document.getElementById('ai-keys-table-body');
            
            if (keys.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="px-6 py-8 text-center text-gray-500">Aucune cl√© API configur√©e</td></tr>';
                return;
            }
            
            tbody.innerHTML = keys.map(key => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${key.provider}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${key.name || '-'}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-mono">${key.api_key}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${key.username || 'Syst√®me'}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${key.monthly_limit_usd ? key.monthly_limit_usd + '$' : 'Illimit√©'}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        ${key.is_default ? '<span class="badge badge-success">D√©faut</span>' : ''}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="deleteAIKey('${key.id}')" class="text-red-600 hover:text-red-900">
                            <i class="fas fa-trash"></i> Supprimer
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // AI Key Management
        function showAddAIKeyModal() {
            document.getElementById('add-ai-key-modal').classList.add('show');
        }

        document.getElementById('add-ai-key-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            try {
                const formData = {
                    provider: document.getElementById('ai-key-provider').value,
                    name: document.getElementById('ai-key-name').value,
                    apiKey: document.getElementById('ai-key-api-key').value,
                    apiSecret: document.getElementById('ai-key-api-secret').value,
                    monthlyLimitUSD: document.getElementById('ai-key-monthly-limit').value,
                    isDefault: document.getElementById('ai-key-is-default').checked
                };
                
                const data = await apiCall('/admin/ai-keys', {
                    method: 'POST',
                    body: JSON.stringify(formData)
                });
                
                if (data.success) {
                    showNotification('Cl√© API ajout√©e avec succ√®s', 'success');
                    closeModal('add-ai-key-modal');
                    loadAIKeys();
                    document.getElementById('add-ai-key-form').reset();
                }
            } catch (error) {
                console.error('Failed to add AI key:', error);
                showNotification('Erreur lors de l\'ajout de la cl√© API', 'error');
            }
        });

        async function deleteAIKey(keyId) {
            if (!confirm('√ätes-vous s√ªr de vouloir supprimer cette cl√© API ?')) return;
            
            try {
                const data = await apiCall(`/admin/ai-keys/${keyId}`, {
                    method: 'DELETE'
                });
                
                if (data.success) {
                    showNotification('Cl√© API supprim√©e', 'success');
                    loadAIKeys();
                }
            } catch (error) {
                console.error('Failed to delete AI key:', error);
                showNotification('Erreur lors de la suppression', 'error');
            }
        }

        // User Details
        async function viewUserDetails(userId) {
            try {
                const data = await apiCall(`/admin/users/${userId}`);
                
                if (data.success) {
                    const modal = document.getElementById('user-detail-modal');
                    const content = document.getElementById('user-detail-content');
                    
                    content.innerHTML = `
                        <div class="space-y-4">
                            <div>
                                <h3 class="font-semibold text-gray-700">Informations G√©n√©rales</h3>
                                <div class="mt-2 space-y-2">
                                    <p><strong>Username:</strong> ${data.user.username}</p>
                                    <p><strong>Email:</strong> ${data.user.email}</p>
                                    <p><strong>T√©l√©phone:</strong> ${data.user.phone_number || 'N/A'}</p>
                                    <p><strong>R√¥le:</strong> ${data.user.role}</p>
                                    <p><strong>Statut:</strong> ${data.user.is_active ? 'Actif' : 'Inactif'}</p>
                                </div>
                            </div>
                            
                            ${data.subscription ? `
                            <div>
                                <h3 class="font-semibold text-gray-700">Abonnement</h3>
                                <div class="mt-2 space-y-2">
                                    <p><strong>Plan:</strong> ${data.subscription.display_name}</p>
                                    <p><strong>Prix:</strong> ${data.subscription.price_monthly}‚Ç¨/mois</p>
                                    <p><strong>Statut:</strong> ${data.subscription.status}</p>
                                </div>
                            </div>
                            ` : '<p class="text-gray-500">Aucun abonnement actif</p>'}
                            
                            <div>
                                <h3 class="font-semibold text-gray-700">Historique des Transactions</h3>
                                <div class="mt-2 max-h-48 overflow-y-auto">
                                    ${data.transactions.length > 0 ? data.transactions.map(t => `
                                        <div class="border-b py-2">
                                            <p class="text-sm"><strong>${t.plan_name}</strong> - ${t.amount}‚Ç¨</p>
                                            <p class="text-xs text-gray-500">${new Date(t.created_at).toLocaleDateString('fr-FR')} - ${t.status}</p>
                                        </div>
                                    `).join('') : '<p class="text-gray-500 text-sm">Aucune transaction</p>'}
                                </div>
                            </div>
                        </div>
                    `;
                    
                    modal.classList.add('show');
                }
            } catch (error) {
                console.error('Failed to load user details:', error);
                showNotification('Erreur lors du chargement des d√©tails', 'error');
            }
        }

        // Pagination
        function displayPagination(pagination, type) {
            const container = document.getElementById(`${type}-pagination`);
            const { page, totalPages } = pagination;
            
            container.innerHTML = `
                <div class="text-sm text-gray-700">
                    Page ${page} sur ${totalPages}
                </div>
                <div class="flex gap-2">
                    <button onclick="load${type.charAt(0).toUpperCase() + type.slice(1)}(${page - 1})" 
                            ${page === 1 ? 'disabled' : ''} 
                            class="px-4 py-2 border rounded-lg ${page === 1 ? 'opacity-50 cursor-not-allowed' : 'hover:bg-gray-100'}">
                        Pr√©c√©dent
                    </button>
                    <button onclick="load${type.charAt(0).toUpperCase() + type.slice(1)}(${page + 1})" 
                            ${page === totalPages ? 'disabled' : ''} 
                            class="px-4 py-2 border rounded-lg ${page === totalPages ? 'opacity-50 cursor-not-allowed' : 'hover:bg-gray-100'}">
                        Suivant
                    </button>
                </div>
            `;
        }

        // Search Users
        function searchUsers() {
            loadUsers(1);
        }

        // Refresh
        function handleRefresh() {
            switch(currentTab) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'users':
                    loadUsers();
                    break;
                case 'payments':
                    loadPendingPayments();
                    break;
                case 'plans':
                    loadPlans();
                    break;
                case 'settings':
                    loadSettings();
                    break;
                case 'ai-keys':
                    loadAIKeys();
                    break;
            }
        }

        // Modal Management
        window.openModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add("show");
            }
        }
        
        window.closeModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove("show");
            }
        }

        // Notification
        window.showNotification = function(message, type = 'info') {
            // Simple alert for now, can be replaced with a toast library
            alert(message);
        }

        // Edit User Function
        window.editUser = async function(userId) {
            try {
                const data = await apiCall(`/admin/users/${userId}`);
                
                if (data.success && data.data) {
                    const user = data.data;
                    document.getElementById('edit-user-id').value = user.id;
                    document.getElementById('edit-user-full-name').value = user.full_name || '';
                    document.getElementById('edit-user-email').value = user.email || '';
                    document.getElementById('edit-user-role').value = user.role || 'user';
                    document.getElementById('edit-user-status').value = user.status || 'active';
                    
                    openModal('edit-user-modal');
                }
            } catch (error) {
                console.error('Failed to load user:', error);
                showNotification('Erreur lors du chargement de l\'utilisateur', 'error');
            }
        }

        // Edit Plan Function
        window.editPlan = async function(planId) {
            try {
                const data = await apiCall(`/admin/plans`);
                
                if (data.success && data.data) {
                    const plan = data.data.find(p => p.id === planId);
                    if (plan) {
                        document.getElementById('edit-plan-id').value = plan.id;
                        document.getElementById('edit-plan-name').value = plan.name || '';
                        document.getElementById('edit-plan-price').value = plan.price || 0;
                        document.getElementById('edit-plan-duration').value = plan.duration_days || 30;
                        document.getElementById('edit-plan-vps-limit').value = plan.vps_limit || 1;
                        document.getElementById('edit-plan-description').value = plan.description || '';
                        document.getElementById('edit-plan-is-popular').checked = plan.is_popular || false;
                        
                        openModal('edit-plan-modal');
                    }
                }
            } catch (error) {
                console.error('Failed to load plan:', error);
                showNotification('Erreur lors du chargement du plan', 'error');
            }
        }

        // Edit Setting Function
        window.editSetting = async function(key) {
            try {
                const data = await apiCall(`/admin/settings`);
                
                if (data.success && data.data) {
                    const setting = data.data.find(s => s.key === key);
                    if (setting) {
                        document.getElementById('edit-setting-key').value = setting.key;
                        document.getElementById('edit-setting-key-display').value = setting.key;
                        document.getElementById('edit-setting-value').value = setting.value || '';
                        document.getElementById('edit-setting-description').value = setting.description || '';
                        
                        openModal('edit-setting-modal');
                    }
                }
            } catch (error) {
                console.error('Failed to load setting:', error);
                showNotification('Erreur lors du chargement du param√®tre', 'error');
            }
        }

        // Form Submit Handlers
        document.addEventListener('DOMContentLoaded', function() {
            // Edit User Form
            document.getElementById('edit-user-form')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const userId = document.getElementById('edit-user-id').value;
                const updates = {
                    full_name: document.getElementById('edit-user-full-name').value,
                    email: document.getElementById('edit-user-email').value,
                    role: document.getElementById('edit-user-role').value,
                    status: document.getElementById('edit-user-status').value
                };
                
                try {
                    const data = await apiCall(`/admin/users/${userId}`, {
                        method: 'PUT',
                        body: JSON.stringify(updates)
                    });
                    
                    if (data.success) {
                        showNotification('Utilisateur modifi√© avec succ√®s', 'success');
                        closeModal('edit-user-modal');
                        loadUsers(currentPage);
                    }
                } catch (error) {
                    console.error('Failed to update user:', error);
                    showNotification('Erreur lors de la modification de l\'utilisateur', 'error');
                }
            });
            
            // Edit Plan Form
            document.getElementById('edit-plan-form')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const planId = document.getElementById('edit-plan-id').value;
                const updates = {
                    name: document.getElementById('edit-plan-name').value,
                    price: parseFloat(document.getElementById('edit-plan-price').value),
                    duration_days: parseInt(document.getElementById('edit-plan-duration').value),
                    vps_limit: parseInt(document.getElementById('edit-plan-vps-limit').value),
                    description: document.getElementById('edit-plan-description').value,
                    is_popular: document.getElementById('edit-plan-is-popular').checked
                };
                
                try {
                    const data = await apiCall(`/admin/plans/${planId}`, {
                        method: 'PUT',
                        body: JSON.stringify(updates)
                    });
                    
                    if (data.success) {
                        showNotification('Plan modifi√© avec succ√®s', 'success');
                        closeModal('edit-plan-modal');
                        loadPlans();
                    }
                } catch (error) {
                    console.error('Failed to update plan:', error);
                    showNotification('Erreur lors de la modification du plan', 'error');
                }
            });
            
            // Edit Setting Form
            document.getElementById('edit-setting-form')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const key = document.getElementById('edit-setting-key').value;
                const value = document.getElementById('edit-setting-value').value;
                
                try {
                    const data = await apiCall(`/admin/settings/${key}`, {
                        method: 'PUT',
                        body: JSON.stringify({ value })
                    });
                    
                    if (data.success) {
                        showNotification('Param√®tre modifi√© avec succ√®s', 'success');
                        closeModal('edit-setting-modal');
                        loadSettings();
                    }
                } catch (error) {
                    console.error('Failed to update setting:', error);
                    showNotification('Erreur lors de la modification du param√®tre', 'error');
                }
            });
        });
    </script>
    <!-- Edit User Modal -->
    <div id="edit-user-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold">Modifier l'Utilisateur</h2>
                <button onclick="closeModal('edit-user-modal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <form id="edit-user-form" class="space-y-4">
                <input type="hidden" id="edit-user-id">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nom complet</label>
                    <input type="text" id="edit-user-full-name" required class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" id="edit-user-email" required class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">R√¥le</label>
                    <select id="edit-user-role" class="w-full px-4 py-2 border rounded-lg">
                        <option value="user">Utilisateur</option>
                        <option value="admin">Administrateur</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Statut</label>
                    <select id="edit-user-status" class="w-full px-4 py-2 border rounded-lg">
                        <option value="active">Actif</option>
                        <option value="inactive">Inactif</option>
                        <option value="suspended">Suspendu</option>
                    </select>
                </div>
                <div class="flex gap-4">
                    <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg">
                        Enregistrer
                    </button>
                    <button type="button" onclick="closeModal('edit-user-modal')" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg">
                        Annuler
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Plan Modal -->
    <div id="edit-plan-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold">Modifier le Plan</h2>
                <button onclick="closeModal('edit-plan-modal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <form id="edit-plan-form" class="space-y-4">
                <input type="hidden" id="edit-plan-id">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nom du Plan</label>
                    <input type="text" id="edit-plan-name" required class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Prix (‚Ç¨)</label>
                    <input type="number" step="0.01" id="edit-plan-price" required class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Dur√©e (jours)</label>
                    <input type="number" id="edit-plan-duration" required class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Limite VPS</label>
                    <input type="number" id="edit-plan-vps-limit" required class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea id="edit-plan-description" rows="3" class="w-full px-4 py-2 border rounded-lg"></textarea>
                </div>
                <div class="flex items-center">
                    <input type="checkbox" id="edit-plan-is-popular" class="mr-2">
                    <label for="edit-plan-is-popular" class="text-sm font-medium text-gray-700">Plan populaire</label>
                </div>
                <div class="flex gap-4">
                    <button type="submit" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg">
                        Enregistrer
                    </button>
                    <button type="button" onclick="closeModal('edit-plan-modal')" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg">
                        Annuler
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Setting Modal -->
    <div id="edit-setting-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold">Modifier le Param√®tre</h2>
                <button onclick="closeModal('edit-setting-modal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <form id="edit-setting-form" class="space-y-4">
                <input type="hidden" id="edit-setting-key">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Cl√©</label>
                    <input type="text" id="edit-setting-key-display" readonly class="w-full px-4 py-2 border rounded-lg bg-gray-100">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Valeur</label>
                    <input type="text" id="edit-setting-value" required class="w-full px-4 py-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea id="edit-setting-description" readonly rows="2" class="w-full px-4 py-2 border rounded-lg bg-gray-100"></textarea>
                </div>
                <div class="flex gap-4">
                    <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg">
                        Enregistrer
                    </button>
                    <button type="button" onclick="closeModal('edit-setting-modal')" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 rounded-lg">
                        Annuler
                    </button>
                </div>
            </form>
        </div>
    </div>

</body>
</html>
