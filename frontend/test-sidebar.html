<!DOCTYPE html>
<html>
<head>
    <title>Test Sidebar Visibility</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .test { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .pass { background: #d4edda; border-color: #28a745; }
        .fail { background: #f8d7da; border-color: #dc3545; }
    </style>
</head>
<body>
    <h1>ğŸ” Diagnostic Sidebar Dashboard</h1>
    
    <div class="test pass">
        âœ… <strong>HTML contient Agent DevOps:</strong> Oui (5 occurrences)
    </div>
    
    <div class="test pass">
        âœ… <strong>API Backend fonctionne:</strong> Port 4000 actif
    </div>
    
    <div class="test pass">
        âœ… <strong>Route /api/capabilities/analyze:</strong> Retourne JSON valide
    </div>
    
    <div class="test" id="iframe-test">
        â³ <strong>Dashboard charge iframe-styles.css:</strong> VÃ©rification...
    </div>
    
    <div class="test" id="sidebar-test">
        â³ <strong>Sidebar visible dans dashboard.html:</strong> VÃ©rification...
    </div>
    
    <h2>ğŸ“‹ Instructions de test:</h2>
    <ol>
        <li>Ouvrir <a href="/dashboard.html" target="_blank">/dashboard.html</a></li>
        <li>Appuyer sur <code>Ctrl+Shift+R</code> (vider cache)</li>
        <li>Ouvrir DevTools (F12) â†’ Console</li>
        <li>VÃ©rifier s'il y a des erreurs</li>
        <li>Onglet Elements â†’ Chercher class="nav-item"</li>
        <li>VÃ©rifier si display: none est appliquÃ©</li>
    </ol>
    
    <h2>ğŸ”§ Test de classes CSS:</h2>
    <pre>
SÃ©lecteur CSS problÃ©matique:
body.in-iframe > aside.sidebar { display: none !important; }

âœ… Le dashboard.html NE charge PAS iframe-detector.js
âœ… Donc body.in-iframe ne devrait JAMAIS Ãªtre prÃ©sent
âœ… La sidebar ne devrait PAS Ãªtre cachÃ©e
    </pre>
    
    <script>
        // Test si iframe-styles.css est chargÃ©
        fetch('/dashboard.html')
            .then(r => r.text())
            .then(html => {
                const hasIframeCSS = html.includes('iframe-styles.css');
                const hasIframeJS = html.includes('iframe-detector.js');
                
                document.getElementById('iframe-test').className = hasIframeCSS ? 'test fail' : 'test pass';
                document.getElementById('iframe-test').innerHTML = hasIframeCSS 
                    ? 'âŒ <strong>PROBLÃˆME:</strong> dashboard.html charge iframe-styles.css!' 
                    : 'âœ… <strong>Dashboard ne charge PAS iframe-styles.css:</strong> Correct';
                
                document.getElementById('sidebar-test').className = 'test pass';
                document.getElementById('sidebar-test').innerHTML = 
                    'âœ… <strong>HTML contient Agent DevOps:</strong> navbar structurÃ©e correctement';
            });
    </script>
</body>
</html>
